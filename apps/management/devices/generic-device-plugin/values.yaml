---
# yaml-language-server: $schema=https://raw.githubusercontent.com/bjw-s-labs/helm-charts/main/charts/library/common/values.schema.json
defaultPodOptions:
  priorityClassName: system-node-critical

controllers:
  generic-device-plugin:
    type: daemonset
    strategy: RollingUpdate
    containers:
      app:
        image:
          repository: ghcr.io/squat/generic-device-plugin
          tag: latest@sha256:eebecd9172b4c2a61e4b3149c943a4ef2c293d7ceb89b69fec5ce5092eb7cf16
        args:
        - --device
        - |
          name: tun
          groups:
            - count: 1000
              paths:
                - path: /dev/net/tun
        resources:
          requests:
            cpu: 50m
            memory: 10Mi
          limits:
            cpu: 50m
            memory: 20Mi
        securityContext:
          privileged: true

persistence:
  dev:
    type: hostPath
    hostPath: /dev
    globalMounts:
      - readOnly: true
  device-plugin:
    type: hostPath
    hostPath: /var/lib/kubelet/device-plugins
