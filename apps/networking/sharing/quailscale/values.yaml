---
# yaml-language-server: $schema=https://raw.githubusercontent.com/bjw-s-labs/helm-charts/main/charts/library/common/values.schema.json
controllers:
  quailscale:
    pod:
      securityContext:
        fsGroup: 979
        fsGroupChangePolicy: "OnRootMismatch"

    containers:
      alpine:
        image:
          repository: alpine
          tag: 3.21.3@sha256:a8560b36e8b8210634f77d9f7f9efd7ffa463e380b75e2e74aff4511df3ef88c
          pullPolicy: IfNotPresent
        command: ["/bin/sh", "-c", "tail -f /dev/null"]
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true

service:
  tailscale:
    enabled: true
    controller: quailscale
    annotations:
      external-dns.alpha.kubernetes.io/hostname: qbittorrent.localdomain
    type: LoadBalancer
    loadBalancerClass: tailscale
    ports:
      tailscale:
        port: 8022

persistence:
  books:
    enabled: true
    type: nfs
    server: new-peepums
    path: '/volume1/media/books/Calibre Library'
    advancedMounts:
      quailscale:
        tailscale:
          - path: /share/books
            readOnly: true
  anime:
    enabled: true
    type: nfs
    server: new-peepums
    path: '/volume1/media/plex/anime'
    advancedMounts:
      quailscale:
        tailscale:
          - path: /share/anime
            readOnly: true
  movies:
    enabled: true
    type: nfs
    server: new-peepums
    path: '/volume1/media/plex/movies'
    advancedMounts:
      quailscale:
        tailscale:
          - path: /share/movies
            readOnly: true
  tv:
    enabled: true
    type: nfs
    server: new-peepums
    path: '/volume1/media/plex/tv'
    advancedMounts:
      quailscale:
        tailscale:
          - path: /share/tv
            readOnly: true
